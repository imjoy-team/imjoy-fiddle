(function(e){function t(t){for(var r,o,s=t[0],c=t[1],l=t[2],u=0,p=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(r=!1)}r&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},i={app:0},a=[];function o(e){return s.p+"js/"+({about:"about"}[e]||e)+"."+{about:"1ce866fd"}[e]+".js"}function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=i[e]=[t,r]}));t.push(n[2]=r);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=o(e);var l=new Error;a=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",l.name="ChunkLoadError",l.type=r,l.request=a,n[1](l)}i[e]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"1f40":function(e,t,n){},"4b75":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},a=[],o=n("2877"),s={},c=Object(o["a"])(s,i,a,!1,null,null,null),l=c.exports,u=n("9483");Object(u["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});n("d3b7");var d=n("8c4f"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"lds-ellipsis"},[n("div"),n("div"),n("div"),n("div")]),n("div",{staticClass:"navbar",attrs:{"is-block":""}},[n("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/"}}},[n("img",{attrs:{src:"https://imjoy.io/static/img/imjoy-logo-black.png",alt:"ImJoy"}})]),e.config.show_file_menu?n("b-navbar-dropdown",{attrs:{label:"File"}},[n("b-navbar-item",{attrs:{disabled:e.loading,href:"#"},on:{click:function(t){return e.showOpenFileDialog()}}},[n("b-icon",{attrs:{icon:"folder-open"}}),e._v(" Open ")],1),e._l(e.config.templates,(function(t){return n("b-navbar-item",{directives:[{name:"show",rawName:"v-show",value:e.config.enable_tempates,expression:"config.enable_tempates"}],key:t.name,attrs:{href:"#"},on:{click:function(n){return e.loadTemplate(t)}}},[n("b-icon",{attrs:{icon:"file-star-outline"}}),e._v(e._s(t.name)+" ")],1)})),n("b-navbar-item",{directives:[{name:"show",rawName:"v-show",value:e.config.enable_save,expression:"config.enable_save"}],attrs:{href:"#"},on:{click:function(t){return e.saveFile()}}},[n("b-icon",{attrs:{icon:"file-download-outline"}}),e._v(" Save File ")],1)],2):e._e(),e.config.show_install&&e.api&&e.api.installPlugin?n("b-navbar-item",{attrs:{disabled:e.loading,href:"#"},on:{click:e.install}},[n("b-icon",{attrs:{icon:"harddisk-plus"}}),e._v(" Install ")],1):e._e(),e.originalSource&&e.codeChanged?n("b-navbar-item",{attrs:{href:"#"},on:{click:e.resetSourceCode}},[n("b-icon",{attrs:{icon:"backup-restore"}}),e._v(" Reset ")],1):e._e(),e._l(e.config.ui_elements||{},(function(t,r){return["button"===t.type?n("b-navbar-item",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"elm.visible"}],key:r,style:t.style,attrs:{href:"#"},on:{click:function(n){return t.callback(e.code)}}},[t.icon?n("b-icon",{attrs:{icon:t.icon}}):e._e(),e._v(" "+e._s(t.label)+" ")],1):"dropdown"===t.type?n("b-navbar-dropdown",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"elm.visible"}],key:r,attrs:{label:t.label}},e._l(t.items,(function(t){return n("b-navbar-item",{key:t.label,style:t.style,attrs:{href:"#"},on:{click:function(n){return t.callback(e.code)}}},[e._v(" "+e._s(t.label)+" ")])})),1):e._e()]})),e.config.enable_run_button?n("b-navbar-item",{attrs:{disabled:e.loading,href:"#"},on:{click:e.run}},[n("b-icon",{attrs:{icon:"play"}}),e._v(" Run ")],1):e._e(),e.pluginAPI?n("b-navbar-dropdown",{attrs:{disabled:e.loading,label:"Plugin API"}},e._l(e.pluginAPI,(function(t,r){return n("b-navbar-item",{key:r,attrs:{href:"#"},on:{click:function(t){return e.runPluginAPI(r)}}},[e._v(" "+e._s(r)+" ")])})),1):e._e(),e.config.enable_stop_button?n("b-navbar-item",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticStyle:{color:"#ff0080cf"},attrs:{href:"#"},on:{click:e.stop}},[n("b-icon",{attrs:{icon:"stop"}}),e._v(" Stop ")],1):e._e()],2),n("div",{staticClass:"editor"},[n("codemirror",{ref:"cmEditor",attrs:{options:e.cmOptions},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1)])},f=[],h=(n("99af"),n("caad"),n("b0c0"),n("b64b"),n("ac1f"),n("25f0"),n("8a79"),n("5319"),n("96cf"),n("1da1")),g=n("b85c"),m=n("9224");function b(e){return v.apply(this,arguments)}function v(){return v=Object(h["a"])(regeneratorRuntime.mark((function e(t){var n,r,i,a,o,s,c,l,u,d,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.loadSourceCode,r=t.setContent,i=t.getContent,a=t.setLoader,o=t.updateUIElement,s=t.addUIElement,c=t.removeUIElement,l=t.setLang,e.next=3,window.imjoyLoader.loadImJoyRPC({api_version:"0.2.3"});case 3:return u=e.sent,e.next=6,u.setupRPC({name:"ImJoyFiddle",version:"0.1.0",description:"ImJoyFiddle -- a playground for ImJoy plugins",type:"rpc-window",defaults:{}});case 6:return d=e.sent,p={setup:function(){d.log("ImJoyFiddle loaded successfully.")},run:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e&&(e.data||e.config)&&n(e.data&&e.data.code,e.config);case 1:case"end":return t.stop()}}),t)})))()},setContent:r,getContent:i,setLoader:a,setLang:l,updateUIElement:o,addUIElement:s,removeUIElement:c},d.export(p),e.abrupt("return",d);case 10:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}var w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{attrs:{action:""}},[n("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[e._v(e._s(e.title))]),n("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(t){return e.$emit("close")}}})]),n("section",{staticClass:"modal-card-body"},[n("b-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("b-tab-item",{attrs:{label:"Local File"}},[n("b-field",[n("b-upload",{attrs:{"drag-drop":""},model:{value:e.localFile,callback:function(t){e.localFile=t},expression:"localFile"}},[n("section",{staticClass:"section"},[n("div",{staticClass:"content has-text-centered"},[n("b-icon",{attrs:{icon:"upload",size:"is-large"}}),e._v(" Drop your files here or click to upload ")],1),e.localFile?n("span",{staticClass:"tag is-primary"},[e._v(" "+e._s(e.localFile.name.slice(0,20)+(e.localFile.name.length>20?"...":""))+" "),n("button",{staticClass:"delete is-small",attrs:{type:"button"},on:{click:function(t){t.preventDefault(),e.localFile=null}}})]):e._e()])])],1)],1),n("b-tab-item",{attrs:{label:"Web URL"}},[n("b-field",{attrs:{label:"URL",type:e.webURLError?"is-danger":"",message:e.webURLError}},[n("b-input",{attrs:{type:"url",maxlength:"1024"},on:{input:function(t){e.webURLError=null}},model:{value:e.webURL,callback:function(t){e.webURL=t},expression:"webURL"}})],1)],1),n("b-tab-item",{attrs:{visible:!!e.octokit,label:"Gist",icon:"github"}},[e.gistTreeConfig?n("tree",{attrs:{config:e.gistTreeConfig}}):e._e(),e.currentGistPage>0?n("b-button",{attrs:{size:"is-small","icon-left":"chevron-left"},on:{click:function(t){e.currentGistPage=e.currentGistPage-1,e.listGists()}}},[e._v(" Previous ")]):e._e(),n("b-button",{attrs:{size:"is-small","icon-left":"chevron-right"},on:{click:function(t){e.currentGistPage=e.currentGistPage+1,e.listGists()}}},[e._v(" Next ")])],1),n("b-tab-item",{attrs:{visible:!!e.octokit,label:"Github",icon:"github"}},[e.userInfo?n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("b-select",{attrs:{expanded:"",sytle:"width: 100px;",placeholder:"Select a user/organization"},on:{input:function(t){return e.listRepos()}},model:{value:e.selectedUser,callback:function(t){e.selectedUser=t},expression:"selectedUser"}},[n("option",{domProps:{value:e.userInfo.login}},[e._v(e._s(e.userInfo.login))]),e._l(e.orgas,(function(t){return n("option",{directives:[{name:"show",rawName:"v-show",value:e.orgas,expression:"orgas"}],key:t.id,domProps:{value:t.login}},[e._v(" "+e._s(t.login)+" ")])}))],2)],1),n("div",{staticClass:"column"},[n("b-autocomplete",{attrs:{data:e.repos,placeholder:"Select a repo",field:"name","open-on-focus":!0,"check-infinite-scroll":!0},on:{select:function(t){e.selectedRepo=t.name,e.listBranches()},"infinite-scroll":e.getMoreRepos},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[e._v(" "+e._s(t.option.name)+" ")])]}}],null,!1,2321554399),model:{value:e.selectedRepo,callback:function(t){e.selectedRepo=t},expression:"selectedRepo"}})],1),n("div",{staticClass:"column"},[e.branches?n("b-select",{attrs:{expanded:"",sytle:"width: 100px;",placeholder:"Select a branch"},on:{input:function(t){return e.getTree()}},model:{value:e.selectedBranch,callback:function(t){e.selectedBranch=t},expression:"selectedBranch"}},e._l(e.branches,(function(t){return n("option",{key:t.id,domProps:{value:t.name}},[e._v(" "+e._s(t.name)+" ")])})),0):e._e()],1)]):e._e(),e.githubTreeConfig?n("tree",{attrs:{config:e.githubTreeConfig}}):e._e()],1),n("b-tab-item",{attrs:{visible:!e.octokit,label:"Github",icon:"github"}},[n("div",{staticClass:"buttons"},[n("b-button",{attrs:{type:"is-primary",expanded:"","icon-left":"github"},on:{click:function(t){return e.connectGithub()}}},[e._v(" Connect Github ")])],1)])],1)],1),n("footer",{staticClass:"modal-card-foot"},[n("b-button",{attrs:{label:"Close"},on:{click:function(t){return e.$emit("close")}}}),n("b-button",{attrs:{disabled:!e.hasSelected,label:"Select",type:"is-primary"},on:{click:function(t){return e.fileSelected()}}})],1)])])},_=[],k=(n("4de4"),n("1276"),n("5530")),x=n("2f62"),y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"list-widget"},[n("sl-vue-tree",{ref:"slVueTree",attrs:{"allow-multiselect":e.allowMultiselect},on:{select:e.nodeSelected,drop:e.nodeDropped,toggle:e.nodeToggled,nodedblclick:e.nodeDbClick},scopedSlots:e._u([{key:"title",fn:function(t){var r=t.node;return[n("span",{staticClass:"item-icon"},[r.isLeaf?n("b-icon",{staticClass:"small-icon",attrs:{icon:"file-outline"}}):n("b-icon",{staticClass:"small-icon",attrs:{icon:"folder-outline"}})],1),e._v(" "+e._s(r.title)+" ")]}},{key:"toggle",fn:function(t){var r=t.node;return[r.isLeaf?e._e():n("span",[r.isExpanded?n("b-icon",{staticClass:"small-icon",attrs:{icon:"chevron-down"}}):n("b-icon",{staticClass:"small-icon",attrs:{icon:"chevron-right"}})],1)]}}]),model:{value:e.config.nodes,callback:function(t){e.$set(e.config,"nodes",t)},expression:"config.nodes"}},[n("template",{slot:"draginfo"},[e._v(" "+e._s(e.selectedNodesTitle)+" ")])],2)],1)},R=[],j=(n("a15b"),n("d81d"),n("4b75"),n("c536")),O=n.n(j),C={name:"tree-widget",type:"tree",components:{SlVueTree:O.a},props:{config:{type:Object,default:function(){return{}}}},data:function(){return{lastEvent:"No last event",selectedNodesTitle:"",allowMultiselect:!1}},created:function(){this.config.allow_multi_select=this.allowMultiselect},mounted:function(){if(this.config._resolve){var e=this;this.config._resolve({_rintf:!0,get_nodes:function(){return e.config.nodes},clear_nodes:function(){e.config.nodes=[],e.$forceUpdate()},set_nodes:function(t){e.config.nodes=t,e.$forceUpdate()}})}},methods:{toggleVisibility:function(e,t){var n=this.$refs.slVueTree;e.stopPropagation();var r=!t.data||!1!==t.data.visible;n.updateNode(t.path,{data:{visible:!r}}),this.lastEvent="Node ".concat(t.title," is ").concat(r?"visible":"invisible"," now")},nodeSelected:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.selectedNodesTitle=e.map((function(e){return e.title})).join(", "),t.lastEvent="Select nodes: ".concat(t.selectedNodesTitle),!t.config.node_select_callback){n.next=10;break}return n.prev=3,t.$emit("loading",!0),n.next=7,t.config.node_select_callback(e);case 7:return n.prev=7,t.$emit("loading",!1),n.finish(7);case 10:case"end":return n.stop()}}),n,null,[[3,,7,10]])})))()},nodeToggled:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,i,a,o,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.lastEvent="Node ".concat(e.title," is ").concat(e.isExpanded?"expanded":"collapsed"),!t.config.node_toggle_callback){n.next=11;break}return n.prev=2,t.$emit("loading",!0),n.next=6,t.config.node_toggle_callback(e);case 6:if(r=n.sent,r){i={children:t.config.nodes},a=Object(g["a"])(e.path);try{for(a.s();!(o=a.n()).done;)s=o.value,i=i.children[s]}catch(c){a.e(c)}finally{a.f()}i.children=r.children,t.$forceUpdate()}case 8:return n.prev=8,t.$emit("loading",!1),n.finish(8);case 11:case"end":return n.stop()}}),n,null,[[2,,8,11]])})))()},nodeDbClick:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.config.node_dbclick_callback){n.next=8;break}return n.prev=1,t.$emit("loading",!0),n.next=5,t.config.node_dbclick_callback(e);case 5:return n.prev=5,t.$emit("loading",!1),n.finish(5);case 8:case"end":return n.stop()}}),n,null,[[1,,5,8]])})))()},nodeDropped:function(e,t){var n=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n.lastEvent="Nodes: ".concat(e.map((function(e){return e.title})).join(", ")," are dropped ").concat(t.placement," ").concat(t.node.title),!n.config.node_drop_callback){r.next=9;break}return r.prev=2,n.$emit("loading",!0),r.next=6,n.config.node_drop_callback(e,t);case 6:return r.prev=6,n.$emit("loading",!1),r.finish(6);case 9:case"end":return r.stop()}}),r,null,[[2,,6,9]])})))()}}},S=C,T=(n("d60a"),Object(o["a"])(S,y,R,!1,null,null,null)),U=T.exports,F=(n("fb6a"),n("07ac"),n("4d63"),n("2532"),n("466d"),n("3835"));var E=/^(?:\w+:)?\/\/([\s\S]+)$/,L=/^localhost[:?\d]*(?:[^:?\d][\s\S]*)?$/,$=/^[^\s.]+\.[\s\S]{2,}$/;function P(e){if("string"!==typeof e)return!1;var t=e.match(E);if(!t)return!1;var n=t[1];return!!n&&!(!L.test(n)&&!$.test(n))}var I=/(?:(?:[^:]+:)?[/][/])?(?:.+@)?([^/]+)([/][^?#]+)/;function G(e,t){var n={};if(t=t||{},!e)return null;if(e.url&&(e=e.url),"string"!==typeof e)return null;var r=e.match(/^([\w-_]+)\/([\w-_.]+)(?:#([\w-_.]+))?$/),i=e.match(/^github:([\w-_]+)\/([\w-_.]+)(?:#([\w-_.]+))?$/),a=e.match(/^git@[\w-_.]+:([\w-_]+)\/([\w-_.]+)$/);if(r)n.user=r[1],n.repo=r[2],n.branch=r[3]||"master",n.host="github.com";else if(i)n.user=i[1],n.repo=i[2],n.branch=i[3]||"master",n.host="github.com";else if(a)n.user=a[1],n.repo=a[2].replace(/\.git$/i,""),n.branch="master",n.host="github.com";else{if(e=e.replace(/^git\+/,""),!P(e))return null;var o=e.match(I)||[],s=Object(F["a"])(o,3),c=s[1],l=s[2];if(!c)return null;if("github.com"!==c&&"www.github.com"!==c&&!t.enterprise)return null;var u=l.match(/^\/([\w-_]+)\/([\w-_.]+)(\/tree\/[\w-_./]+)?(\/blob\/[\s\w-_./]+)?/);if(!u)return null;n.user=u[1],n.repo=u[2].replace(/\.git$/i,""),n.host=c||"github.com",u[3]&&/^\/tree\/master\//.test(u[3])?(n.branch="master",n.path=u[3].replace(/\/$/,"")):u[3]?n.branch=u[3].replace(/^\/tree\//,"").match(/[\w-_.]+\/{0,1}[\w-_]+/)[0]:u[4]?n.branch=u[4].replace(/^\/blob\//,"").match(/[\w-_.]+\/{0,1}[\w-_]+/)[0]:n.branch="master"}return"github.com"===n.host?n.apiHost="api.github.com":n.apiHost="".concat(n.host,"/api/v3"),n.tarball_url="https://".concat(n.apiHost,"/repos/").concat(n.user,"/").concat(n.repo,"/tarball/").concat(n.branch),n.clone_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo),"master"===n.branch?(n.https_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo),n.travis_url="https://travis-ci.org/".concat(n.user,"/").concat(n.repo),n.zip_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo,"/archive/master.zip")):(n.https_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo,"/blob/").concat(n.branch),n.travis_url="https://travis-ci.org/".concat(n.user,"/").concat(n.repo,"?branch=").concat(n.branch),n.zip_url="https://".concat(n.host,"/").concat(n.user,"/").concat(n.repo,"/archive/").concat(n.branch,".zip")),n.path&&(n.https_url+=n.path),n.api_url="https://".concat(n.apiHost,"/repos/").concat(n.user,"/").concat(n.repo),n}function N(e,t){return A.apply(this,arguments)}function A(){return A=Object(h["a"])(regeneratorRuntime.mark((function e(t,n){var r,i,a,o,s,c,l,u,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.includes("gist.github.com")){e.next=16;break}return r=t.split("/").slice(-1)[0],e.next=4,fetch("https://api.github.com/gists/"+r).then((function(e){return e.blob()}));case 4:return i=e.sent,e.t0=JSON,e.next=8,new Response(i).text();case 8:if(e.t1=e.sent,a=e.t0.parse.call(e.t0,e.t1),!n){e.next=15;break}return o=Object.values(a.files).filter((function(e){return e.filename.endsWith(n)}))[0],e.abrupt("return",o&&o.raw_url);case 15:return e.abrupt("return",a.files[Object.keys(a.files)[0]].raw_url);case 16:if(t.includes("blob")&&t.includes("github")){e.next=18;break}return e.abrupt("return",null);case 18:return s=G(t),c=s.user,l=s.repo,u=new RegExp("^https://github.com/"+c+"/"+l+"/blob/","g"),d=t.replace(u,""),e.abrupt("return","https://raw.githubusercontent.com/"+c+"/"+l+"/"+d);case 24:case"end":return e.stop()}}),e)}))),A.apply(this,arguments)}var M=n("d20a"),B=n.n(M),z=n("1af2"),J={name:"file-selection",props:["title","selected"],components:{tree:U},data:function(){return{localFile:null,webURL:null,webURLError:null,gistTreeConfig:null,githubTreeConfig:null,selectedGistFile:null,selectedGithubFile:null,currentGistPage:0,currentRepoPage:0,activeTab:0,orgas:null,userInfo:null,repos:null,branches:null,selectedUser:null,selectedRepo:null,selectedBranch:null}},mounted:function(){this.octokit&&(this.listOwners(),this.listGists())},computed:Object(k["a"])({urlValid:function(){return!!this.webURL&&!this.webURLError},hasSelected:function(){return 0===this.activeTab?!!this.localFile:1===this.activeTab?this.urlValid:2===this.activeTab?!!this.selectedGistFile:3===this.activeTab&&!!this.selectedGithubFile}},Object(x["b"])({octokit:function(e){return e.octokit}})),methods:{connectGithub:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.octokit){t.next=3;break}return t.next=3,e.loginGithub();case 3:e.listOwners(),e.listGists();case 5:case"end":return t.stop()}}),t)})))()},listOwners:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.githubTreeConfig=null,e.selectedUser=null,e.selectedRepo=null,e.selectedBranch=null,t.next=6,e.octokit.rest.users.getAuthenticated();case 6:return e.userInfo=t.sent.data,t.next=9,e.octokit.rest.orgs.listForAuthenticatedUser();case 9:return e.orgas=t.sent.data,e.selectedUser=e.userInfo.login,t.next=13,e.listRepos();case 13:case"end":return t.stop()}}),t)})))()},getRepos:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.selectedUser!==e.userInfo.login){t.next=6;break}return t.next=3,e.octokit.rest.repos.listForAuthenticatedUser({sort:"updated",per_page:20,page:e.currentRepoPage});case 3:n=t.sent.data,t.next=9;break;case 6:return t.next=8,e.octokit.rest.repos.listForOrg({org:e.selectedUser});case 8:n=t.sent.data;case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}}),t)})))()},listRepos:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.githubTreeConfig=null,e.selectedRepo=null,e.selectedBranch=null,e.currentRepoPage=0,t.next=6,e.getRepos();case 6:e.repos=t.sent;case 7:case"end":return t.stop()}}),t)})))()},getMoreRepos:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.currentRepoPage=e.currentRepoPage+1,t.t0=e.repos,t.next=4,e.getRepos();case 4:t.t1=t.sent,e.repos=t.t0.concat.call(t.t0,t.t1);case 6:case"end":return t.stop()}}),t)})))()},listBranches:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.githubTreeConfig=null,e.selectedBranch=null,n=e.repos.filter((function(t){return t.name===e.selectedRepo}))[0],t.next=5,e.octokit.rest.repos.listBranches({owner:n.owner.login,repo:e.selectedRepo});case 5:if(e.branches=t.sent.data,e.selectedBranch=n.default_branch,!e.selectedBranch){t.next=10;break}return t.next=10,e.getTree();case 10:case"end":return t.stop()}}),t)})))()},getTree:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n,r,i,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.githubTreeConfig=null,n=e.$buefy.loading.open({container:e.$el}),r=e,i=e.repos.filter((function(t){return t.name===e.selectedRepo}))[0],a=function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t,n){var a,o,s,c,l,u,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.octokit.rest.git.getTree({owner:i.owner.login,repo:i.name,tree_sha:t});case 2:a=e.sent.data,o=[],s=Object(g["a"])(a.tree);try{for(s.s();!(c=s.n()).done;)l=c.value,l.name=l.path,n&&(l.path=n+"/"+l.path),"tree"===l.type?(u={title:l.name,isExpanded:!1,children:[],data:l},o.push(u)):(d={title:l.name,isExpanded:!1,data:l,isLeaf:!0},o.push(d))}catch(p){s.e(p)}finally{s.f()}return e.abrupt("return",o.sort((function(e,t){var n=e.isLeaf,r=t.isLeaf;return!0!==n||r?!0!==r||n?e.title<t.title?-1:e.title>t.title?1:0:-1:1})));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.prev=5,o=e.branches.filter((function(t){return t.name===e.selectedBranch}))[0],e.selectedGithubFile=null,t.t0=function(e){"blob"===e[0].data.type?r.selectedGithubFile=e[0].data:r.selectedGithubFile=null,r.$forceUpdate()},t.t1=function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isExpanded){t.next=5;break}return t.next=3,a(e.data.sha,e.data.path);case 3:e.children=t.sent,r.$forceUpdate();case 5:return t.abrupt("return",e);case 6:case"end":return t.stop()}}),t)})))()},t.next=12,a(o.commit.sha);case 12:t.t2=t.sent,e.githubTreeConfig={node_select_callback:t.t0,node_toggle_callback:t.t1,nodes:t.t2},e.$forceUpdate(),t.next=20;break;case 17:throw t.prev=17,t.t3=t["catch"](5),t.t3;case 20:return t.prev=20,n.close(),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[5,17,20,23]])})))()},listGists:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n,r,i,a,o,s,c,l,u,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$buefy.loading.open({container:e.$el}),t.prev=1,t.next=4,e.octokit.rest.gists.list({per_page:10,page:e.currentGistPage});case 4:r=t.sent,i=e,e.selectedGistFile=null,e.gistTreeConfig={node_select_callback:function(e){e[0].data.raw_url?i.selectedGistFile=e[0].data:i.selectedGistFile=null,i.$forceUpdate()}},e.gistTreeConfig.nodes=[],a=Object(g["a"])(r.data);try{for(a.s();!(o=a.n()).done;){for(s=o.value,c={title:s.id,isExpanded:!1,children:[],data:s},l=0,u=Object.keys(s.files);l<u.length;l++)d=u[l],c.children.push({title:d,isLeaf:!0,data:s.files[d]});e.gistTreeConfig.nodes.push(c)}}catch(p){a.e(p)}finally{a.f()}t.next=16;break;case 13:throw t.prev=13,t.t0=t["catch"](1),t.t0;case 16:return t.prev=16,n.close(),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[1,13,16,19]])})))()},loginGithub:function(){var e=this;return new Promise((function(t,n){var r=new B.a({site_id:"if.imjoy.io"});r.authenticate({provider:"github",scope:"user"},function(){var r=Object(h["a"])(regeneratorRuntime.mark((function r(i,a){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!i){r.next=5;break}return e.$store.commit("setOctokit",null),alert("Error Authenticating with GitHub: "+i),n(i),r.abrupt("return");case 5:e.$store.commit("setOctokit",new z["a"]({auth:a.token})),e.activeTab=3,t();case 8:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())}))},fileSelected:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n,r,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0===e.activeTab&&(e.selected(e.localFile,e.localFile.name),e.$emit("close")),1!==e.activeTab){t.next=15;break}return t.next=4,N(e.webURL);case 4:if(t.t0=t.sent,t.t0){t.next=7;break}t.t0=e.webURL;case 7:n=t.t0,r=new XMLHttpRequest,r.open("HEAD",n),r.onload=Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.readyState==r.DONE&&(404==r.status||e.webURLError?e.webURLError="Invalid URL":(e.selected(n,n.split("/").pop().split("#")[0].split("?")[0]),e.$emit("close")));case 1:case"end":return t.stop()}}),t)}))),r.onerror=function(){e.webURLError="Invalid URL"},r.send(),t.next=28;break;case 15:if(2!==e.activeTab){t.next=21;break}console.log(e.selectedGistFile),e.selected(e.selectedGistFile.raw_url,e.selectedGistFile.filename),e.$emit("close"),t.next=28;break;case 21:return i=e.repos.filter((function(t){return t.name===e.selectedRepo}))[0],console.log("===>",e.selectedGithubFile),t.next=25,e.octokit.rest.repos.getContent({owner:i.owner.login,repo:i.name,path:"/"+e.selectedGithubFile.path});case 25:a=t.sent.data,e.selected(a.download_url,e.selectedGithubFile.name),e.$emit("close");case 28:case"end":return t.stop()}}),t)})))()}}},V=J,D=Object(o["a"])(V,w,_,!1,null,null,null),W=D.exports,H=n("8f94"),q=(n("a7be"),n("9603"),n("f9d4"),n("db91"),n("d69f"),n("959b"),n("693d"),n("31c5"),n("9948"),n("b933"),n("9c7b"),n("715d"),n("23de"),n("4ba6"),n("8c33"),n("7289"),n("2aed"),n("d72f"),n("0b6c"),n("9a48"),n("697e"),n("aedd"),n("164b"),n("4895"),n("cbc8"),n("9f09"),n("a2c1"),{name:"htmlmixed",tags:{docs:[[null,null,"markdown"]],config:[["lang",/^json$/,"javascript"],["lang",/^yaml$/,"yaml"],[null,null,"javascript"]],script:[["lang",/^python$/,"python"],[null,null,"javascript"]]}}),K={name:"ImJoyEditor",components:{codemirror:H["codemirror"]},data:function(){return{config:{show_file_menu:!0,show_install:!1},version:m["a"],code:"",loading:!1,originalSource:null,api:null,plugin:null,imjoyTemplates:[{name:"empty",url:null,lang:"html"},{name:"window",url:"https://raw.githubusercontent.com/imjoy-team/ImJoy/master/web/src/plugins/windowTemplate.imjoy.html",lang:"html"},{name:"web-worker",url:"https://raw.githubusercontent.com/imjoy-team/ImJoy/master/web/src/plugins/webWorkerTemplate.imjoy.html",lang:"html"},{name:"web-python",url:"https://raw.githubusercontent.com/imjoy-team/ImJoy/master/web/src/plugins/webPythonTemplate.imjoy.html",lang:"html"},{name:"native-python",url:"https://raw.githubusercontent.com/imjoy-team/ImJoy/master/web/src/plugins/nativePythonTemplate.imjoy.html",lang:"html"}],cmOptions:{styleActiveLine:!0,lineNumbers:!0,line:!0,foldGutter:!0,styleSelectedText:!0,keyMap:"sublime",tabSize:4,indentUnit:4,smartIndent:!0,matchBrackets:!0,showCursorWhenSelecting:!0,theme:"mbo",hintOptions:{completeSingle:!1},gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],mode:q,extraKeys:{Ctrl:"autocomplete",F11:function(e){e.setOption("fullScreen",!e.getOption("fullScreen"))},Esc:function(e){e.getOption("fullScreen")&&e.setOption("fullScreen",!1)},Tab:"indentMore","Shift-Tab":function(e){e.indentSelection("subtract")}}}}},mounted:function(){var e=this;window.self!==window.top&&b({setContent:function(e){this.code=e},getContent:function(){return this.code},loadSourceCode:this.loadSourceCode,setLoader:this.setLoader,updateUIElement:this.updateUIElement,addUIElement:this.addUIElement,removeUIElement:this.removeUIElement,setLang:this.setLang}).then((function(t){e.api=t})),window.addEventListener("resize",this.updateSize),this.updateSize()},beforeDestroy:function(){window.removeEventListener("resize",this.updateSize)},computed:{codeChanged:function(){return this.originalSource&&this.originalSource!==this.code},editor:function(){return this.$refs.cmEditor.codemirror},pluginAPI:function(){if(!this.plugin)return null;for(var e={},t=0,n=Object.keys(this.plugin);t<n.length;t++){var r=n[t];["on","off","_rintf","emit","setup"].includes(r)||(e[r]=this.plugin[r])}return e}},methods:{loadCodeFromFile:function(e){var t=this;if(e){var n=new FileReader;n.onload=function(){var r=n.result;t.originalSource=r,t.setLang(t.inferLang(e.name)),t.editor.setValue(r)},n.onerror=function(e){console.error(e),t.api.showMessage("Failed to load plugin source code, error: ".concat(e)),t.$forceUpdate()},n.readAsText(e)}},loadSourceCode:function(e,t){var n=this;if(e=e||"",this.originalSource=e,this.editor.setValue(e),this.config=t||{},this.config.enable_tempates&&!this.config.templates?this.config.templates=this.imjoyTemplates:this.config.templates&&void 0===this.config.enable_tempates&&(this.config.enable_tempates=!0),this.config.ui_elements)for(var r=function(){var e=a[i],t=n.config.ui_elements[e];t.shortcut&&(n.cmOptions.extraKeys[t.shortcut]=function(){t.callback(n.code)})},i=0,a=Object.keys(this.config.ui_elements);i<a.length;i++)r();else this.config.enable_tempates=!0,this.config.templates=this.imjoyTemplates,this.config.enable_run_button=!0,this.config.enable_save=!0,this.config.enable_stop_button=!0;if(this.setLang(),void 0===this.config.show_file_menu&&(this.config.show_file_menu=!0),this.config.fold)if(Array.isArray(this.config.fold)){var o,s=Object(g["a"])(this.config.fold);try{for(s.s();!(o=s.n()).done;){var c=o.value;this.editor.foldCode(this.editor.constructor.Pos(c,0))}}catch(l){s.e(l)}finally{s.f()}}else this.editor.foldCode(this.editor.constructor.Pos(this.config.fold,0))},resetSourceCode:function(){this.originalSource&&this.editor.setValue(this.originalSource)},updateSize:function(){var e=document.body.getBoundingClientRect();this.editor.setSize(e.width,e.height-52),setTimeout(this.editor.refresh(),1)},loadTemplate:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.url,r){n.next=4;break}return t.code="",n.abrupt("return");case 4:return n.next=6,fetch(r).then((function(e){return e.blob()}));case 6:return i=n.sent,n.next=9,new Response(i).text();case 9:a=n.sent,t.code=a,t.setLang(e.lang);case 12:case"end":return n.stop()}}),n)})))()},install:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,e.api.installPlugin({code:e.editor.getValue(),namespace:e.config.namespace});case 4:e.plugin=t.sent,e.api.showMessage("Successfully installed plugin."),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.api.showMessage("Failed to install plugin, error: "+t.t0.toString());case 11:return t.prev=11,e.loading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})))()},inferLang:function(e){e.endsWith(".js")?this.config.lang="javascript":e.endsWith(".yml")||e.endsWith(".yaml")?this.config.lang="yaml":e.endsWith(".py")?this.config.lang="python":e.endsWith(".imjoy.html")?this.config.lang="imjoy":e.endsWith(".md")?this.config.lang="markdown":this.config.lang="text"},setLang:function(e){this.config.lang=e||this.config.lang||"html","html"===this.config.lang?this.cmOptions.mode=q:"js"===this.config.lang||"javascript"===this.config.lang?this.cmOptions.mode={name:"javascript"}:"py"===this.config.lang||"python"===this.config.lang?this.cmOptions.mode={name:"python"}:"markdown"===this.config.lang?this.cmOptions.mode={name:"text/x-markdown"}:"imjoy"===this.config.lang?this.cmOptions.mode=q:this.cmOptions.mode={name:this.config.lang||"text/plain"}},run:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,e.api.showProgress(0),t.next=5,e.api.loadPlugin({src:e.editor.getValue()},{namespace:e.config.namespace});case 5:if(e.plugin=t.sent,e.loading){t.next=9;break}return e.plugin=null,t.abrupt("return");case 9:if(e.loading){t.next=11;break}return t.abrupt("return");case 11:if(!e.plugin.run){t.next=15;break}return t.next=14,e.plugin.run({config:{},data:{}});case 14:return t.abrupt("return",t.sent);case 15:if(e.loading){t.next=17;break}return t.abrupt("return");case 17:t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](0),e.api.showMessage("Failed to load plugin, error: "+t.t0.toString());case 22:return t.prev=22,e.loading=!1,e.api.showProgress(100),t.finish(22);case 26:case"end":return t.stop()}}),t,null,[[0,19,22,26]])})))()},setLoader:function(e){this.loading=e,this.$forceUpdate()},updateUIElement:function(e,t){for(var n=this.config.ui_elements[e],r=0,i=Object.keys(t);r<i.length;r++){var a=i[r];n[a]=t[a]}},addUIElement:function(e,t){this.config.ui_elements[e]=t,this.$forceUpdate()},removeUIElement:function(e){delete this.config.ui_elements[e],this.$forceUpdate()},stop:function(){this.loading=!1},runPluginAPI:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,t.loading=!0,"function"!==typeof t.plugin[e]){n.next=12;break}if("run"!==e){n.next=8;break}return n.next=6,t.plugin[e]({config:{},data:{}});case 6:n.next=10;break;case 8:return n.next=10,t.plugin[e]();case 10:n.next=13;break;case 12:t.api.alert(JSON.stringify(t.plugin[e]));case 13:n.next=18;break;case 15:n.prev=15,n.t0=n["catch"](0),t.api.showMessage("Failed to run api function (".concat(e,"), error: ").concat(n.t0));case 18:return n.prev=18,t.loading=!1,n.finish(18);case 21:case"end":return n.stop()}}),n,null,[[0,15,18,21]])})))()},loadCodeFromURL:function(e,t){var n=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var i,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,fetch(e).then((function(e){return e.blob()}));case 2:return i=r.sent,r.next=5,new Response(i).text();case 5:a=r.sent,n.code=a,n.setLang(t);case 8:case"end":return r.stop()}}),r)})))()},showOpenFileDialog:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e,t.next=3,e.$buefy.modal.open({parent:e,component:W,props:{title:"Open File",selected:function(e,t){console.log("loading file from ",e,t),e instanceof Blob?n.loadCodeFromFile(e):n.loadCodeFromURL(e,n.inferLang(t))}},hasModalCard:!0,customClass:"custom-class custom-class-2",trapFocus:!0});case 3:case"end":return t.stop()}}),t)})))()},saveFile:function(){var e=this.editor.getValue(),t=/<.*>\s*{\s*"name":\s*"(.*)"\s*,/gm,n=t.exec(e)[1];this.api.exportFile(e,(n||"myPlugin").replace(/\s+/g,"-")+".imjoy.html")}}},X=K,Q=(n("d703"),Object(o["a"])(X,p,f,!1,null,null,null)),Y=Q.exports;r["a"].use(d["a"]);var Z=[{path:"/",redirect:{name:"App"}},{path:"/app",name:"App",component:Y},{path:"/about",name:"About",component:function(){return n.e("about").then(n.bind(null,"f820"))}}],ee=new d["a"]({base:"/",routes:Z}),te=ee,ne=n("289d");n("5363"),n("5abe");r["a"].use(x["a"]);var re=new x["a"].Store({state:{octokit:null},mutations:{setOctokit:function(e,t){e.octokit=t}}});r["a"].use(ne["a"]),r["a"].config.productionTip=!1,new r["a"]({router:te,render:function(e){return e(l)},store:re}).$mount("#app")},6271:function(e,t,n){},9224:function(e){e.exports=JSON.parse('{"a":"0.1.3"}')},d60a:function(e,t,n){"use strict";var r=n("1f40"),i=n.n(r);i.a},d703:function(e,t,n){"use strict";var r=n("6271"),i=n.n(r);i.a}});
//# sourceMappingURL=app.461c7a0f.js.map